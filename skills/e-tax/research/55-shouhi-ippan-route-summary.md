# 55 - 一般課税（本則課税）ルート サマリ

## 画面フロー

### A. 割戻し計算（デフォルト）
1. ac0100 条件判定等 → invoice=はい, niwariTokurei=いいえ, kani=いいえ, siireKeisanHouhou=warimodosi
2. ac0250 所得区分の選択 → ヘッダに「一般課税」表示
3. ai0150 売上（収入）金額・仕入金額等の入力ハブ
4. ai3600/inputEigyo 事業所得（営業等）の売上入力（フォーム名は2割特例/簡易課税と同一）
5. ai3600/submit 中間納付税額等の入力
6. ac0300 計算結果の確認

### B. 積上げ計算
1. ac0100 条件判定等 → invoice=はい, niwariTokurei=いいえ, kani=いいえ, siireKeisanHouhou=tumiage
2. ac0250 所得区分の選択 → ヘッダに「一般課税」表示
3. ai0150 売上（収入）金額・仕入金額等の入力ハブ
   - **仕入金額等を入力する必要あり**のインフォメーション表示
4. ai3600/inputEigyo 事業所得（営業等）の売上入力
5. **ai3610/submit 決算額・課税取引金額の内訳等の入力** ← 積上げ専用画面（後述）
6. ai3600/submit 中間納付税額等の入力
7. ac0300 計算結果の確認

## URL体系
- 一般課税: `/syouhi/ai****` (ippan の i)
- 簡易課税: `/syouhi/ak****` (kani の k)
- 共通: `/syouhi/ac****` (common)

## 条件判定画面の追加項目（一般課税専用）

### 税額計算方法（折りたたみセクション内）
| フィールド | id | type | 選択肢 |
|---|---|---|---|
| 売上税額の計算方法 | uriageKeisanHouhou | select | 1: 割戻し計算, 2: 積上げ計算, 3: 1と2の併用 |
| 仕入税額の計算方法 | siire-warimodosi / siire-tumiage | radio | warimodosi: 割戻し計算, tumiage: 積上げ計算 |

### 特別な売上基準（折りたたみセクション内）
- 割賦基準、延払基準等、工事進行基準、現金主義会計 の適用

## 所得区分の選択（一般課税専用追加項目）
| チェックボックス | 備考 |
|---|---|
| 業務用固定資産等の購入がある | 一般課税のみ表示（2割特例/簡易課税では非表示） |

## 売上入力フォーム
売上入力のフォームフィールド名は2割特例/簡易課税と**同一**（uriageWari等）。
ただし一般課税の場合、ヘッダに「一般課税 税込 **割戻**」または「一般課税 税込 **積上**」と計算方法が表示される。

## 決算額・課税取引金額の内訳等の入力（積上げ計算専用）

### 概要
`ai3610/submit.htmj` - 積上げ計算選択時のみ表示される巨大フォーム。
青色申告決算書の勘定科目ごとに、決算額・課税取引金額・軽減税率適用分・免税事業者等取引分を入力する。

### テーブル列構成
| 列 | 欄 | 説明 |
|---|---|---|
| A | 決算額 | 決算書の金額（税込） |
| B | うち課税取引にならないもの | 非課税・不課税分 |
| C | 課税取引金額（A-B、自動計算） | |
| D+E | うち税率6.24%（軽減税率）適用分 | |
| E | うち免税事業者等取引分 | 経過措置(8割控除)適用分 |
| F+G | うち税率7.8%適用分（自動計算） | |
| G | うち免税事業者等取引分 | 経過措置(8割控除)適用分 |

### 勘定科目とフィールド名パターン
フィールド名は `{科目略称}{列略称}Tumi` のパターン。

| 行番号 | 科目 | フィールド名プレフィックス | 入力列 |
|---|---|---|---|
| (1) | 売上（収入）金額 | uriage | A のみ（自動転記） |
| (2) | 期首商品棚卸高 | kisyuTanaorosi | A |
| (3) | 仕入金額 | siire | A, B, D+E, E, F+G（自動）, G |
| (4) | 小計 | uriageGenkaSyokei | 自動計算 |
| (5) | 期末商品棚卸高 | kimatuTanaorosi | A |
| (6) | 差引原価 | sasihikiGenka | 自動計算 |
| (7) | 差引金額 | uriageSasihikiKingaku | 自動計算 |
| (8) | 租税公課 | sozeiKoka | A, B, F+G（自動）, G |
| (9) | 荷造運賃 | nidukuri | A, B, F+G（自動）, G |
| (10) | 水道光熱費 | suido | A, F+G（自動）, G |
| (11) | 旅費交通費 | ryohi | A, B, F+G（自動）, G |
| (12) | 通信費 | tusin | A, B, D+E, E, F+G（自動）, G |
| (13) | 広告宣伝費 | kokoku | A, B, D+E, E, F+G（自動）, G |
| (14) | 接待交際費 | settai | A, B, D+E, E, F+G（自動）, G |
| (15) | 損害保険料 | songai | A, B（自動非課税） |
| (16) | 修繕費 | syuzen | A, F+G（自動）, G |
| (17) | 消耗品費 | syomohin | A, D+E, E, F+G（自動）, G |
| (18) | 減価償却費 | genkasyokyaku | A, B（自動非課税） |
| (19) | 福利厚生費 | fukurikosei | A, B, D+E, E, F+G（自動）, G |
| (20) | 給料賃金 | kyuryo | A, B, F+G（自動）, G |
| (21) | 外注工賃 | gaichu | A, B, F+G（自動）, G |
| (22) | 利子割引料 | risiWaribiki | A, B（自動非課税） |
| (23) | 地代家賃 | jidai | A, B, F+G（自動）, G |
| (24) | 貸倒金 | kasidaore | A, B（自動非課税） |
| (25)-(30) | 任意科目 | niniKamoku25-30 | A, B, D+E, E, F+G（自動）, G |
| (31) | 雑費 | zappi | A, B, D+E, E, F+G（自動）, G |
| (32) | 計 | 全項目自動計算 | |
| (33) | 差引金額 | 自動計算 | |

### 積上げ消費税額の入力（テーブル下部）
| フィールド | 説明 |
|---|---|
| 免税事業者等以外の取引に係る消費税額（6.24%） | 積上げ計算で算出した税額 |
| 免税事業者等以外の取引に係る消費税額（7.8%） | 積上げ計算で算出した税額 |
| 免税事業者等取引に係る消費税額（6.24%） | 経過措置80%控除分の税額 |
| 免税事業者等取引に係る消費税額（7.8%） | 経過措置80%控除分の税額 |

### 追加質問（ラジオボタン）
| 質問 | はい/いいえ |
|---|---|
| 発生した貸倒金はあるか？ | radio |
| 回収した貸倒金はあるか？ | radio |
| 保税地域からの引取貨物はあるか？ | radio |
| 課税仕入れに係る対価の返還等はあるか？ | radio |
| 令和7年に課税事業者になった＋期首棚卸高あり？ | radio |
| 令和8年に免税事業者になる＋期末棚卸高あり？ | radio |

### ボタン
| ボタン | 遷移先 |
|---|---|
| 次へ進む | 売上入力ハブ → 中間納付 → 計算結果 |
| 前に戻る | 売上入力フォーム |

## 中間納付税額等の入力
2割特例/簡易課税と同一フィールド。

| name | id | 備考 |
|---|---|---|
| chukanNofuZei | chukanNofuZei | 中間納付消費税額 |
| chukanNofuJotoWari | chukanNofuJotoWari | 中間納付譲渡割額 |

## 計算結果
一般課税の計算結果表示はac0300画面（共通）。
ヘッダ部に「一般課税」表示で区別。

### テストデータでの計算例（割戻し計算、仕入なし）
- 売上（税込）: 5,500,000円
- 課税標準額: 5,000,000円
- 消費税額: 390,000円
- 控除対象仕入税額: 312,000円（= 390,000 × 80%、2割特例相当）
  - ※仕入なしの場合、2割特例と同一の控除額になる
- 差引税額: 78,000円
- 地方消費税 譲渡割額: 22,000円
- 合計納付: 100,000円

## 3ルートの主な違いまとめ

| 項目 | 2割特例 | 簡易課税 | 一般課税（割戻し） | 一般課税（積上げ） |
|---|---|---|---|---|
| 条件設定 | niwariTokurei=true | kani=true | kani=false, siire=warimodosi | kani=false, siire=tumiage |
| URL prefix | /ai**** | /ak**** | /ai**** | /ai**** |
| 売上入力 | 同一フォーム | 同一フォーム | 同一フォーム | 同一フォーム |
| 仕入入力 | 不要 | 不要 | 不要 | **決算額テーブル（194項目）** |
| 控除計算 | 消費税額×80% | みなし仕入率 | 割戻し方式 | 積上げ方式 |
| 所得区分の固定資産購入 | なし | なし | あり | あり |

## スクリーンショット
- `56-shouhi-ippan-sales-hub.png` - 一般課税 売上入力ハブ
- `57-shouhi-ippan-eigyo-input.png` - 一般課税 売上入力フォーム
- `58-shouhi-ippan-result.png` - 一般課税 計算結果（割戻し）
- `59-shouhi-ippan-condition-expanded.png` - 条件判定（積上げセクション展開）
- `60-shouhi-ippan-hub-shiire-required.png` - 一般課税ハブ（仕入入力必須メッセージ）
- `61-shouhi-ippan-kessangaku-top.png` - 決算額・課税取引金額の内訳テーブル
